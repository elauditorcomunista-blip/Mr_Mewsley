// ===============================
// ü¶ù Sistema de personajes Lackadaisy
// ===============================

// M√°ximo un usuario por personaje
const personajeLimite = {
  rocky: 1,
  mordecai: 1,
  ivy: 1,
  freckle: 1,
  mitzi: 1
};

// Almacenamiento temporal (se reinicia al reiniciar el bot)
const personajeAsignado = {
  rocky: [],
  mordecai: [],
  ivy: [],
  freckle: [],
  mitzi: []
};

module.exports = {
  name: 'interactionCreate',

  async execute(interaction) {
    if (!interaction.isStringSelectMenu()) return;
    if (interaction.customId !== 'menu_personajes') return;

    const elegido = interaction.values[0];
    const userId = interaction.user.id;

    // üß© Verifica si ya tiene un personaje
    for (const personaje in personajeAsignado) {
      if (personajeAsignado[personaje].includes(userId)) {
        return await interaction.reply({
          content: `‚ö†Ô∏è Ya tienes un personaje asignado (**${personaje}**). No puedes elegir otro.`,
          ephemeral: true
        });
      }
    }

    // üö´ Si el personaje ya est√° ocupado
    if (personajeAsignado[elegido].length >= personajeLimite[elegido]) {
      return await interaction.reply({
        content: `‚ùå El personaje **${elegido}** ya est√° ocupado.`,
        ephemeral: true
      });
    }

    // ‚úÖ Asigna el personaje
    personajeAsignado[elegido].push(userId);

    await interaction.reply({
      content: `‚úÖ Se te ha asignado el personaje **${elegido.charAt(0).toUpperCase() + elegido.slice(1)}**.`,
      ephemeral: true
    });
  }

const { handleSelect } = require('./commands/roles/rol.js');

client.on('interactionCreate', async (interaction) => {
  if (interaction.isCommand()) {
    // Aqu√≠ cargas tus comandos slash
    const command = client.commands.get(interaction.commandName);
    if (command) await command.execute(interaction);
  }

  if (interaction.isStringSelectMenu()) {
    await handleSelect(interaction);
  }
});

};
